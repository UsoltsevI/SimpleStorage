# Пояснительная записка

Простое монолитное веб-приложение с открытым исходным кодом,
позволяющее зарегистрированным
пользователям хранить свои файлы на сервере.

## Структура объектов

Все java классы, относящиеся к проекту, находятся в 
пакете org.example.sstorage. 

Структура внутри org.example.sstorage:

#### config
Пакет с классами, отвечающими за конфигурацию.

1. **MinIOConfig** Настраивает клиент MinIO для 
общения с ней. Требует следующих настроек конфигурации в файле
`application.properties` из папки resources:
    - minio.endpoint - адрес подключения к MinIO
    - minio.accessKey (см. документацию к [MinIO](https://min.io/docs/minio/container/administration/identity-access-management/minio-user-management.html))
    - minio.secretKey (см. документацию к [MinIO](https://min.io/docs/minio/container/administration/identity-access-management/minio-user-management.html))
    - minio.bucket-name - корзина для хранения файлов

2. **MultipartConfig** Настраивает ограничения размера файлов, 
загружаемых на сервер через [Multipart](https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods/multipart-forms.html). 
Имеет дефолтные настройки, но позволяет
ручную настройку через application.properties:
    - multipart.max-file-size (10 by default) - максимальный размер одного файла
    - multipart.max-request-size (20 by default) - максимальный размер запроса

3. **MvcConfig** Настраивает статические отображения
общедоступных страниц "/" и "/login". *Сделан для того, чтобы не 
писать под это функции в контроллерах*

2. **PasswordConfig** Содержит бин, который возвращает 
passwordEncoder для хэширования паролей перед их 
3сохранением в базу данных и проверкой прав доступа по паролю.

2. **SecurityConfig** Настраивает Spring SecurityFilterChain
для проверки прав доступа пользователя перед возвращением страницы.
 
3. **SecurityJdbcConfig** Настраивает бин DataSource для общения
с базой данных. Требует следующих настроек конфигурации в файле 
`application.properties` з папки resources:
    - spring.datasource.url - адрес базы данных. Пример: `jdbc:postgresql://spostgres:5432/suserdb`.
    - spring.datasource.username - пользователь для работы с БД
    - spring.datasource.password - пароль для работы с БД
    - spring.datasource.driver-class-name - драйвер для работы с сервером

#### controllers
Пакет, содержащий REST контроллеры для сообщения с клиентом.

1. **AdminController** Отвечает за запросы, которые 
доступны только пользователю с ролью ADMIN.

2. **ExceptionController** Отвечает за справление исключений. 
То есть в случае возникновения ошибок на сервере принимает 
решение, какую страницу отобразить пользователю и какое сообщение вывести.

3. **RegisterController** Отвечает за страницу регистрации.

4. **SUserController** Отвечает за запросы, относящиеся к 
основным функциям, предоставляемым пользователям.

#### entities

1. **FileSave** класс для передачи данных о файле для 
сохранения его в базе данных.
2. **SFile** сущность, отвечающая за данные об объектах, 
которые хранятся в хранилище.
3. **SRole** имплементация GrantedAuthority для астройки SpringSecurity 
4. **SUser** сущность, содержаая данные о пользователе. 
Является моделью данных, хранимых в хранилище.
5. ** UserSave** класс для передачи информации в репозиторий 
для сохранения данных о пользователе.

#### init
Классы, которые занимаются актуализацией данных сразу после 
запуска приложения.

1. **AdminInitializer** сохраняет сущность администратора в
базу данных сразу после запуска приложения.
3. **MinIOInitializer** создаёт корзину в объектном 
хранилище если она ещё не существует.
4. **SqlDbInitializer** создаёт таблица в БД если те ещё не созданы.

#### repositories
Репозитории для абстрагирования работы с хранилищем SQL.

#### services

Сервисы для абстрагирования работы с сущностями и репозиториями.
В том числе объединяют логику общения с PostgreSQL и MinIO.

## Параллельная обработка

При помощи использования фреймворка Spring обеспечивается 
возможность параллельного выполнения запросов, приходящих на сервер
через REST API. Так как сами операции не является длительными, 
ручная работа с многопоточностью не требуется.

## Используемые технологии
## Описание используемых технологий

- [Spring Framework](https://spring.io/)

  Для упрощения разработки и поддержки приложения.
  Также помогает с обеспечением безопасности в приложении.

- [Spring boot 3](https://spring.io/projects/spring-boot)

  Облегчает работу со Spring Framework.

- [Thymeleaf](https://www.thymeleaf.org/)

  Для динамической работы с html станицами.

- [PostgreSQL](https://www.postgresql.org/)

  База данных для хранения метаданных пользователей
  и загруженных ими файлов.

- [MinIO](https://min.io/)

  Объектное хранилище для хранения всех
  файлов пользователей.

- [Gradle](https://gradle.org/)

  Система сбоки проекта. Упрощает управление
  зависимостями, загрузку библиотек и саму сборку проекта.

- [Docker](https://www.docker.com/)

  Используется для контейнеризации приложения
  и баз данных. Обеспечивает удобство развёртывания
  приложения.

- [Lombok](https://projectlombok.org/)

  Для упрощения написания когда на Java.


Помимо упомянутых там используется стандартная библиотека Java.
Lombok для уменьшения количества шаблонного кода. 
Библиотека для общения с MinIO, библиотека для общения с PostgreSQL.
Прочие библиотеки из Spring Framework типа web, config, security, core и т.д.

## Визуальные компоненты

Footer, Header и Home page взяты с сайта шаблонов.
Сами отображения настроены через [Thymeleaf](https://www.thymeleaf.org/) 
и обработку HTML шаблонов (содержимое написано самостоятельно).
